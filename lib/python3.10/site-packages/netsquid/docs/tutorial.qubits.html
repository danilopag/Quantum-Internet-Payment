<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Qubits and quantum computation &mdash; NetSquid 1.1.7 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="_static/style.css" type="text/css" />
    <link rel="shortcut icon" href="_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=370aedac"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Discrete event simulation" href="tutorial.pydynaa.html" />
    <link rel="prev" title="Tutorial" href="tutorial.intro.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #E3E3E3" >

          
          
          <a href="index.html" class="icon icon-home">
            NetSquid
              <img src="_static/squid-150.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                1.1.7
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">About</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="README.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="INSTALL.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="RELEASE.html">Release notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="AUTHORS.html">Authors</a></li>
<li class="toctree-l1"><a class="reference internal" href="LICENSE.html">License</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Learn NetSquid</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="quick_start.html">NetSquid in 10 minutes</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="tutorial.intro.html">Tutorial</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Qubits and quantum computation</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial.pydynaa.html">Discrete event simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial.components.html">Modelling of network components</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial.nodes.html">Nodes and Connections</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial.protocols.html">Protocols</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial.quantumprocessor.html">The Quantum Processor</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial.simulation.html">A full simulation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="learn.examples.html">Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="learn_examples/learn.examples.teleportation.html">Teleportation</a></li>
<li class="toctree-l2"><a class="reference internal" href="learn_examples/learn.examples.repeater.html">Repeater with purification</a></li>
<li class="toctree-l2"><a class="reference internal" href="learn_examples/learn.examples.repeater_chain.html">Repeater chain</a></li>
<li class="toctree-l2"><a class="reference internal" href="learn_examples/learn.examples.simple_link.html">A simple link layer protocol</a></li>
<li class="toctree-l2"><a class="reference internal" href="learn_examples/learn.examples.magic_simple_link.html">Faster Link layer Protocol using abstraction</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api_reference.html">NetSquid package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="netsquid.qubits.html">netsquid.qubits</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api_qubits/netsquid.qubits.qformalism.html">netsquid.qubits.qformalism</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_qubits/netsquid.qubits.qubitapi.html">netsquid.qubits.qubitapi</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_qubits/netsquid.qubits.operators.html">netsquid.qubits.operators</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_qubits/netsquid.qubits.cliffords.html">netsquid.qubits.cliffords</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_qubits/netsquid.qubits.ketstates.html">netsquid.qubits.ketstates</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_qubits/netsquid.qubits.state_sampler.html">netsquid.qubits.state_sampler</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_qubits/netsquid.qubits.qubit.html">netsquid.qubits.qubit</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_qubits/netsquid.qubits.qstate.html">netsquid.qubits.qstate</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_qubits/netsquid.qubits.qrepr.html">netsquid.qubits.qrepr</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_qubits/netsquid.qubits.kettools.html">netsquid.qubits.kettools</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_qubits/netsquid.qubits.dmtools.html">netsquid.qubits.dmtools</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_qubits/netsquid.qubits.sparsedmtools.html">netsquid.qubits.sparsedmtools</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_qubits/netsquid.qubits.stabtools.html">netsquid.qubits.stabtools</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_qubits/netsquid.qubits.gslctools.html">netsquid.qubits.gslctools</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_qubits/netsquid.qubits.qreprutil.html">netsquid.qubits.qreprutil</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_qubits/netsquid.qubits.ketutil.html">netsquid.qubits.ketutil</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_qubits/netsquid.qubits.dmutil.html">netsquid.qubits.dmutil</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_qubits/netsquid.qubits.sparseutil.html">netsquid.qubits.sparseutil</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_qubits/netsquid.qubits.gslcutil.html">netsquid.qubits.gslcutil</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_qubits/netsquid.qubits.opmath.html">netsquid.qubits.opmath</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="netsquid.components.html">netsquid.components</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api_components/netsquid.components.component.html">netsquid.components.component</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_components/netsquid.components.channel.html">netsquid.components.channel</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_components/netsquid.components.qchannel.html">netsquid.components.qchannel</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_components/netsquid.components.cchannel.html">netsquid.components.cchannel</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_components/netsquid.components.cqchannel.html">netsquid.components.cqchannel</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_components/netsquid.components.qmemory.html">netsquid.components.qmemory</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_components/netsquid.components.instructions.html">netsquid.components.instructions</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_components/netsquid.components.qprogram.html">netsquid.components.qprogram</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_components/netsquid.components.qprocessor.html">netsquid.components.qprocessor</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_components/netsquid.components.clock.html">netsquid.components.clock</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_components/netsquid.components.qsource.html">netsquid.components.qsource</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_components/netsquid.components.qdetector.html">netsquid.components.qdetector</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_components/netsquid.components.switch.html">netsquid.components.switch</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_components/netsquid.components.ccoding.html">netsquid.components.ccoding</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="netsquid.components.models.html">netsquid.components.models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api_models/netsquid.components.models.model.html">netsquid.components.models.model</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_models/netsquid.components.models.delaymodels.html">netsquid.components.models.delaymodels</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_models/netsquid.components.models.errormodels.html">netsquid.components.models.errormodels</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_models/netsquid.components.models.qerrormodels.html">netsquid.componentsmodels.qerrormodels</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_models/netsquid.components.models.cerrormodels.html">netsquid.components.models.cerrormodels</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="netsquid.nodes.html">netsquid.nodes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api_nodes/netsquid.nodes.node.html">netsquid.nodes.node</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_nodes/netsquid.nodes.connections.html">netsquid.nodes.connections</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_nodes/netsquid.nodes.network.html">netsquid.nodes.network</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="netsquid.protocols.html">netsquid.protocols</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api_protocols/netsquid.protocols.protocol.html">netsquid.protocols.protocol</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_protocols/netsquid.protocols.nodeprotocols.html">netsquid.protocols.nodeprotocols</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_protocols/netsquid.protocols.serviceprotocol.html">netsquid.protocols.serviceprotocol</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="netsquid.util.html">netsquid.util</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api_util/netsquid.util.simtools.html">netsquid.util.simtools</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_util/netsquid.util.simlog.html">netsquid.util.simlog</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_util/netsquid.util.simstats.html">netsquid.util.simstats</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_util/netsquid.util.datacollector.html">netsquid.util.datacollector</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_util/netsquid.util.cycache.html">netsquid.util.cycache</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_util/netsquid.util.cymath.html">netsquid.util.cymath</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_util/netsquid.util.constrainedmap.html">netsquid.util.constrainedmap</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="netsquid.examples.html">netsquid.examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api_examples/netsquid.examples.teleportation.html">netsquid.examples.teleportation</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_examples/netsquid.examples.entanglenodes.html">netsquid.examples.entanglenodes</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_examples/netsquid.examples.purify.html">netsquid.examples.purify</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_examples/netsquid.examples.repeater.html">netsquid.examples.repeater</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_examples/netsquid.examples.repeater_chain.html">netsquid.examples.repeater_chain</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_examples/netsquid.examples.simple_link.html">netsquid.examples.simple_link</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_examples/netsquid.examples.magic_simple_link.html">netsquid.examples.magic_simple_link</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api_pydynaa.html">pyDynAA package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="pydynaa.html">pydynaa.Entity</a></li>
<li class="toctree-l2"><a class="reference internal" href="pydynaa.html#pydynaa-event">pydynaa.Event</a></li>
<li class="toctree-l2"><a class="reference internal" href="pydynaa.html#pydynaa-eventtype">pydynaa.EventType</a></li>
<li class="toctree-l2"><a class="reference internal" href="pydynaa.html#pydynaa-eventexpression">pydynaa.EventExpression</a></li>
<li class="toctree-l2"><a class="reference internal" href="pydynaa.html#pydynaa-eventhandler">pydynaa.EventHandler</a></li>
<li class="toctree-l2"><a class="reference internal" href="pydynaa.html#pydynaa-expressionhandler">pydynaa.ExpressionHandler</a></li>
<li class="toctree-l2"><a class="reference internal" href="pydynaa.html#pydynaa-simulationengine">pydynaa.SimulationEngine</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">For developers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="INSTALL-SOURCE.html">Installation from source</a></li>
<li class="toctree-l1"><a class="reference internal" href="CONTRIBUTING.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="CHANGELOG.html">Changelog</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #E3E3E3" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">NetSquid</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="tutorial.intro.html">Tutorial</a></li>
      <li class="breadcrumb-item active">Qubits and quantum computation</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/tutorial.qubits.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul><div class="rst-breadcrumbs-buttons" role="navigation" aria-label="Sequential page navigation">
        <a href="tutorial.intro.html" class="btn btn-neutral float-left" title="Tutorial" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="tutorial.pydynaa.html" class="btn btn-neutral float-right" title="Discrete event simulation" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
  </div>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="qubits-and-quantum-computation">
<h1>Qubits and quantum computation<a class="headerlink" href="#qubits-and-quantum-computation" title="Link to this heading"></a></h1>
<p>In this section of the tutorial we will explain the <em>netsquid.qubits</em> subpackage for quantum computation.
We will do so by (loosely) following the example of quantum teleportation in terms of the qubit and quantum state manipulations involved
i.e. purely in terms of the linear algebra, and not yet adding timing or network modelling, which will be discussed in later sections.</p>
<p class="topic-title">Learning goals</p><ul class="simple">
<li><p>Anatomy of qubits and their manipulation via operators and measurements
(<strong>essential</strong>).</p></li>
<li><p>General measurements and the available noise operations
(<strong>advanced</strong>).</p></li>
</ul>
<nav class="contents local" id="table-of-contents">
<p class="topic-title">Table of contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#qubits-and-their-quantum-state" id="id1">Qubits and their quantum state</a></p></li>
<li><p><a class="reference internal" href="#qubit-measurement" id="id2">Qubit measurement</a></p></li>
<li><p><a class="reference internal" href="#quantum-state-formalism" id="id3">Quantum state formalism</a></p></li>
<li><p><a class="reference internal" href="#quantum-operations" id="id4">Quantum operations</a></p></li>
<li><p><a class="reference internal" href="#general-measurements" id="id5">General measurements <sup>*</sup></a></p></li>
<li><p><a class="reference internal" href="#applying-noise" id="id6">Applying noise <sup>*</sup></a></p></li>
</ul>
</nav>
<p><em>Advanced sections are denoted by an asterix (*).</em></p>
<section id="qubits-and-their-quantum-state">
<h2><a class="toc-backref" href="#id1" role="doc-backlink">Qubits and their quantum state</a><a class="headerlink" href="#qubits-and-their-quantum-state" title="Link to this heading"></a></h2>
<p>Qubits are represented by <a class="reference internal" href="api_qubits/netsquid.qubits.qubit.html#netsquid.qubits.qubit.Qubit" title="netsquid.qubits.qubit.Qubit"><code class="xref py py-class docutils literal notranslate"><span class="pre">Qubit</span></code></a> objects.
A qubit holds a quantum state (<a class="reference internal" href="api_qubits/netsquid.qubits.qstate.html#netsquid.qubits.qstate.QState" title="netsquid.qubits.qstate.QState"><code class="xref py py-class docutils literal notranslate"><span class="pre">QState</span></code></a>), which it may dynamically share with other qubits.
When qubits <em>interact</em> their quantum states <em>combine</em> into a shared state,
whereas when qubits are <em>measured</em> their quantum state is <em>split</em> to conserve memory (memory grows superlinearly with the number of qubits).
If a qubit is not required anymore it can be <em>discarded</em>, which removes its existence completely.</p>
<p>For illustration let us start by creating some qubits:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">netsquid</span> <span class="k">as</span> <span class="nn">ns</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q1</span><span class="p">,</span> <span class="n">q2</span> <span class="o">=</span> <span class="n">ns</span><span class="o">.</span><span class="n">qubits</span><span class="o">.</span><span class="n">create_qubits</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>By default each qubit is created in the <span class="math notranslate nohighlight">\(\vert 0\rangle\)</span> state.
To represent this state, every <a class="reference internal" href="api_qubits/netsquid.qubits.qstate.html#netsquid.qubits.qstate.QState" title="netsquid.qubits.qstate.QState"><code class="xref py py-class docutils literal notranslate"><span class="pre">QState</span></code></a> contains a representation (<a class="reference internal" href="api_qubits/netsquid.qubits.qrepr.html#netsquid.qubits.qrepr.QRepr" title="netsquid.qubits.qrepr.QRepr"><code class="xref py py-class docutils literal notranslate"><span class="pre">QRepr</span></code></a>).
The type of representation is determined by the chosen formalism, which is the KET formalism by default.
As we show below the quantum state of a qubit is accessible via its <em>qstate</em> attribute.
However, this is considered <em>low-level</em> access and should not be necessary in practice – we will introduce more convenient methods as we proceed.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q1</span><span class="o">.</span><span class="n">qstate</span><span class="o">.</span><span class="n">num_qubits</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q1</span><span class="o">.</span><span class="n">qstate</span><span class="o">.</span><span class="n">qrepr</span><span class="p">)</span>
<span class="go">KetRepr(num_qubits=1,</span>
<span class="go">ket=</span>
<span class="go">[[1.+0.j]</span>
<span class="go"> [0.+0.j]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q2</span><span class="o">.</span><span class="n">qstate</span><span class="o">.</span><span class="n">qrepr</span><span class="p">)</span>
<span class="go">KetRepr(num_qubits=1,</span>
<span class="go">ket=</span>
<span class="go">[[1.+0.j]</span>
<span class="go"> [0.+0.j]])</span>
</pre></div>
</div>
<p>NetSquid will automatically <em>combine</em> quantum states into a single shared state as qubits interact with each other.
We can also tell NetSquid to do this explicitly, although this should rarely be necessary:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q1</span><span class="o">.</span><span class="n">qstate</span> <span class="o">==</span> <span class="n">q2</span><span class="o">.</span><span class="n">qstate</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ns</span><span class="o">.</span><span class="n">qubits</span><span class="o">.</span><span class="n">combine_qubits</span><span class="p">([</span><span class="n">q1</span><span class="p">,</span> <span class="n">q2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q1</span><span class="o">.</span><span class="n">qstate</span> <span class="o">==</span> <span class="n">q2</span><span class="o">.</span><span class="n">qstate</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q1</span><span class="o">.</span><span class="n">qstate</span><span class="o">.</span><span class="n">num_qubits</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q1</span><span class="o">.</span><span class="n">qstate</span><span class="o">.</span><span class="n">qrepr</span><span class="p">)</span>
<span class="go">KetRepr(num_qubits=2,</span>
<span class="go">ket=</span>
<span class="go">[[1.+0.j]</span>
<span class="go"> [0.+0.j]</span>
<span class="go"> [0.+0.j]</span>
<span class="go"> [0.+0.j]])</span>
</pre></div>
</div>
<p>The recommended way to inspect the quantum state of one or more qubits is to use the <a class="reference internal" href="api_qubits/netsquid.qubits.qubitapi.html#netsquid.qubits.qubitapi.reduced_dm" title="netsquid.qubits.qubitapi.reduced_dm"><code class="xref py py-func docutils literal notranslate"><span class="pre">reduced_dm()</span></code></a> function, which will give a reduced density matrix for any specified qubit(s) in the given order, irrespective of their underlying states:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ns</span><span class="o">.</span><span class="n">qubits</span><span class="o">.</span><span class="n">reduced_dm</span><span class="p">([</span><span class="n">q1</span><span class="p">,</span> <span class="n">q2</span><span class="p">]))</span>
<span class="go">[[1.+0.j 0.+0.j 0.+0.j 0.+0.j]</span>
<span class="go"> [0.+0.j 0.+0.j 0.+0.j 0.+0.j]</span>
<span class="go"> [0.+0.j 0.+0.j 0.+0.j 0.+0.j]</span>
<span class="go"> [0.+0.j 0.+0.j 0.+0.j 0.+0.j]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ns</span><span class="o">.</span><span class="n">qubits</span><span class="o">.</span><span class="n">reduced_dm</span><span class="p">(</span><span class="n">q2</span><span class="p">))</span>
<span class="go">[[1.+0.j 0.+0.j]</span>
<span class="go"> [0.+0.j 0.+0.j]]</span>
</pre></div>
</div>
</section>
<section id="qubit-measurement">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Qubit measurement</a><a class="headerlink" href="#qubit-measurement" title="Link to this heading"></a></h2>
<p>Measuring a qubit will by default split it from its shared quantum state:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q1</span><span class="o">.</span><span class="n">qstate</span><span class="o">.</span><span class="n">num_qubits</span> <span class="o">==</span> <span class="n">q2</span><span class="o">.</span><span class="n">qstate</span><span class="o">.</span><span class="n">num_qubits</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q1</span><span class="o">.</span><span class="n">qstate</span><span class="o">.</span><span class="n">num_qubits</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ns</span><span class="o">.</span><span class="n">qubits</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="n">q1</span><span class="p">)</span>
<span class="go">(0, 1.0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q1</span><span class="o">.</span><span class="n">qstate</span><span class="o">.</span><span class="n">num_qubits</span> <span class="o">==</span> <span class="n">q2</span><span class="o">.</span><span class="n">qstate</span><span class="o">.</span><span class="n">num_qubits</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q1</span><span class="o">.</span><span class="n">qstate</span><span class="o">.</span><span class="n">num_qubits</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ns</span><span class="o">.</span><span class="n">qubits</span><span class="o">.</span><span class="n">reduced_dm</span><span class="p">(</span><span class="n">q1</span><span class="p">))</span>
<span class="go">[[1.+0.j 0.+0.j]</span>
<span class="go"> [0.+0.j 0.+0.j]]</span>
</pre></div>
</div>
<p>The measure operator returns the measurement result and the probability that it measured that result.</p>
<p>Finally, discarding a qubit will not only remove it from its shared quantum state but also leave it stateless:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ns</span><span class="o">.</span><span class="n">qubits</span><span class="o">.</span><span class="n">combine_qubits</span><span class="p">([</span><span class="n">q1</span><span class="p">,</span> <span class="n">q2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q1</span><span class="o">.</span><span class="n">qstate</span><span class="o">.</span><span class="n">num_qubits</span> <span class="o">==</span> <span class="n">q2</span><span class="o">.</span><span class="n">qstate</span><span class="o">.</span><span class="n">num_qubits</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q1</span><span class="o">.</span><span class="n">qstate</span><span class="o">.</span><span class="n">num_qubits</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ns</span><span class="o">.</span><span class="n">qubits</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="n">q2</span><span class="p">,</span> <span class="n">discard</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">(0, 1.0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q2</span><span class="o">.</span><span class="n">qstate</span> <span class="ow">is</span> <span class="kc">None</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q1</span><span class="o">.</span><span class="n">qstate</span><span class="o">.</span><span class="n">num_qubits</span>
<span class="go">1</span>
</pre></div>
</div>
</section>
<section id="quantum-state-formalism">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">Quantum state formalism</a><a class="headerlink" href="#quantum-state-formalism" title="Link to this heading"></a></h2>
<p>The <a class="reference internal" href="api_qubits/netsquid.qubits.qstate.html#netsquid.qubits.qstate.QState" title="netsquid.qubits.qstate.QState"><code class="xref py py-class docutils literal notranslate"><span class="pre">QState</span></code></a> class defines a <em>shared quantum state</em>.
A state is represented by a quantum state <em>formalism</em>, or <em>representation</em>, which is an implement (subclass) of the <a class="reference internal" href="api_qubits/netsquid.qubits.qrepr.html#netsquid.qubits.qrepr.QRepr" title="netsquid.qubits.qrepr.QRepr"><code class="xref py py-class docutils literal notranslate"><span class="pre">QRepr</span></code></a> base class.
In NetSquid the following representations are available as formalisms : <a class="reference internal" href="api_qubits/netsquid.qubits.kettools.html#netsquid.qubits.kettools.KetRepr" title="netsquid.qubits.kettools.KetRepr"><code class="xref py py-class docutils literal notranslate"><span class="pre">KetRepr</span></code></a>, <a class="reference internal" href="api_qubits/netsquid.qubits.dmtools.html#netsquid.qubits.dmtools.DenseDMRepr" title="netsquid.qubits.dmtools.DenseDMRepr"><code class="xref py py-class docutils literal notranslate"><span class="pre">DenseDMRepr</span></code></a>, <a class="reference internal" href="api_qubits/netsquid.qubits.sparsedmtools.html#netsquid.qubits.sparsedmtools.SparseDMRepr" title="netsquid.qubits.sparsedmtools.SparseDMRepr"><code class="xref py py-class docutils literal notranslate"><span class="pre">SparseDMRepr</span></code></a>, <a class="reference internal" href="api_qubits/netsquid.qubits.stabtools.html#netsquid.qubits.stabtools.StabRepr" title="netsquid.qubits.stabtools.StabRepr"><code class="xref py py-class docutils literal notranslate"><span class="pre">StabRepr</span></code></a> and <a class="reference internal" href="api_qubits/netsquid.qubits.gslctools.html#netsquid.qubits.gslctools.GSLCRepr" title="netsquid.qubits.gslctools.GSLCRepr"><code class="xref py py-class docutils literal notranslate"><span class="pre">GSLCRepr</span></code></a>.
These supported formalism can be accessed via <a class="reference internal" href="api_qubits/netsquid.qubits.qformalism.html#netsquid.qubits.qformalism.QFormalism" title="netsquid.qubits.qformalism.QFormalism"><code class="xref py py-obj docutils literal notranslate"><span class="pre">QFormalism</span></code></a>, which provides shorthand notations: <cite>QFormalism.KET</cite>, <cite>QFormalism.DM</cite>, <cite>QFormalism.SPARSEDM</cite>, <cite>QFormalism.STAB</cite> and <cite>QFormalism.GSLC</cite>.
These formalisms have different trade-offs in terms of their memory usage, computation speed, versatility, and universality.
The stabilizer state formalism, for instance, can easily simulate thousands of qubits, but is restricted to Clifford gates, which are not universal.
In the figure below the quantum state representations of an entangled Bell state are shown for three available formalisms, along with their memory scaling with the number of qubits <em>n</em>.
The <a class="reference internal" href="api_qubits/netsquid.qubits.qformalism.html#module-netsquid.qubits.qformalism" title="netsquid.qubits.qformalism"><code class="xref py py-obj docutils literal notranslate"><span class="pre">qformalism</span></code></a> documentation page shows a more in-depth overview of the different formalisms.</p>
<a class="reference internal image-reference" href="_images/qstate_formalisms.png"><img alt="_images/qstate_formalisms.png" class="align-center" src="_images/qstate_formalisms.png" style="width: 600px;" /></a>
<p>The quantum state formalism can be set at the start of a simulation using <a class="reference internal" href="api_qubits/netsquid.qubits.qformalism.html#netsquid.qubits.qformalism.set_qstate_formalism" title="netsquid.qubits.qformalism.set_qstate_formalism"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_qstate_formalism()</span></code></a>.
By default the <em>KET</em> formalism is used in NetSquid.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">netsquid.qubits.qformalism</span> <span class="kn">import</span> <span class="n">QFormalism</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ns</span><span class="o">.</span><span class="n">get_qstate_formalism</span><span class="p">()</span>
<span class="go">&lt;class &#39;netsquid.qubits.kettools.KetRepr&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Change to stabilizer formalism:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ns</span><span class="o">.</span><span class="n">set_qstate_formalism</span><span class="p">(</span><span class="n">QFormalism</span><span class="o">.</span><span class="n">STAB</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ns</span><span class="o">.</span><span class="n">get_qstate_formalism</span><span class="p">()</span>
<span class="go">&lt;class &#39;netsquid.qubits.stabtools.StabRepr&#39;&gt;</span>
</pre></div>
</div>
<p>While NetSquid will attempt to convert shared quantum states if it encounters incompatible formalisms,
it is good practice not to mix formalisms and instead create qubits anew when switching formalism.</p>
<p>It is also possible to assign a quantum state representation manually to qubits, in which case it is more efficient to initialise the qubits to have no state.
For instance, below we assign the state <span class="math notranslate nohighlight">\(\vert +-\rangle\)</span> to two new qubits:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q1</span><span class="p">,</span> <span class="n">q2</span> <span class="o">=</span> <span class="n">ns</span><span class="o">.</span><span class="n">qubits</span><span class="o">.</span><span class="n">create_qubits</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">no_state</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ns</span><span class="o">.</span><span class="n">qubits</span><span class="o">.</span><span class="n">assign_qstate</span><span class="p">([</span><span class="n">q1</span><span class="p">,</span> <span class="n">q2</span><span class="p">],</span> <span class="n">ns</span><span class="o">.</span><span class="n">h01</span><span class="p">)</span>  <span class="c1"># assign |+-&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ns</span><span class="o">.</span><span class="n">qubits</span><span class="o">.</span><span class="n">reduced_dm</span><span class="p">(</span><span class="n">q1</span><span class="p">))</span>
<span class="go">[[0.5+0.j 0.5+0.j]</span>
<span class="go"> [0.5+0.j 0.5+0.j]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ns</span><span class="o">.</span><span class="n">qubits</span><span class="o">.</span><span class="n">reduced_dm</span><span class="p">(</span><span class="n">q2</span><span class="p">))</span>
<span class="go">[[ 0.5+0.j -0.5+0.j]</span>
<span class="go"> [-0.5+0.j  0.5+0.j]]</span>
</pre></div>
</div>
<p>Let us check the underlying quantum state now indeed uses the stabilizer formalism:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">type</span><span class="p">(</span><span class="n">q1</span><span class="o">.</span><span class="n">qstate</span><span class="o">.</span><span class="n">qrepr</span><span class="p">)</span>
<span class="go">&lt;class &#39;netsquid.qubits.stabtools.StabRepr&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q1</span><span class="o">.</span><span class="n">qstate</span><span class="o">.</span><span class="n">qrepr</span><span class="o">.</span><span class="n">check_matrix</span>
<span class="go">array([[1, 0, 0, 0],</span>
<span class="go">       [0, 1, 0, 0]], dtype=uint8)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q1</span><span class="o">.</span><span class="n">qstate</span><span class="o">.</span><span class="n">qrepr</span><span class="o">.</span><span class="n">phases</span>
<span class="go">array([ 1, -1], dtype=int8)</span>
</pre></div>
</div>
</section>
<section id="quantum-operations">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Quantum operations</a><a class="headerlink" href="#quantum-operations" title="Link to this heading"></a></h2>
<p>As we have already seen with functions such as <a class="reference internal" href="api_qubits/netsquid.qubits.qubitapi.html#netsquid.qubits.qubitapi.reduced_dm" title="netsquid.qubits.qubitapi.reduced_dm"><code class="xref py py-func docutils literal notranslate"><span class="pre">reduced_dm()</span></code></a>,
NetSquid offers a <em>formalism agnostic</em> API (<a class="reference internal" href="api_qubits/netsquid.qubits.qubitapi.html#module-netsquid.qubits.qubitapi" title="netsquid.qubits.qubitapi"><code class="xref py py-mod docutils literal notranslate"><span class="pre">qubitapi</span></code></a>) for manipulating qubits, i.e. the provided functions can be called irrespective of the formalism used for the underlying shared quantum states.
The only exception is a small set of functions that do not support the stabilizer formalism (as documented), for example the general measurement function <a class="reference internal" href="api_qubits/netsquid.qubits.qubitapi.html#netsquid.qubits.qubitapi.gmeasure" title="netsquid.qubits.qubitapi.gmeasure"><code class="xref py py-func docutils literal notranslate"><span class="pre">gmeasure()</span></code></a>.</p>
<p>In the example of quantum teleportation the quantum state of Alice’s first qubit (<em>a1</em>) is teleported to Bob’s qubit (<em>b1</em>) by utilising an entangled state between Bob’s qubit and a second qubit of Alice’s (<em>a2</em>).
We initialise these three qubits using the density matrix formalism,
as this will give a meaningful final fidelity for a noisy teleported state without needing to statistically sample.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Change to density matrix formalism:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ns</span><span class="o">.</span><span class="n">set_qstate_formalism</span><span class="p">(</span><span class="n">QFormalism</span><span class="o">.</span><span class="n">DM</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">b1</span> <span class="o">=</span> <span class="n">ns</span><span class="o">.</span><span class="n">qubits</span><span class="o">.</span><span class="n">create_qubits</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<p>We need some state for Alice to teleport,
so let us choose the state</p>
<div class="math notranslate nohighlight">
\[\vert 0_y\rangle =  \frac{\vert 0\rangle+i\vert 1\rangle}{\sqrt{2}}.\]</div>
<p>We can prepare this state from the default <span class="math notranslate nohighlight">\(\vert 0\rangle\)</span> state by applying two operators: the Hadamard (<em>H</em>) operator is used to rotate <span class="math notranslate nohighlight">\(180^\circ\)</span> around the Z+X axis (purple arrow), then the phase (<em>S</em>) operator rotates <span class="math notranslate nohighlight">\(90^\circ\)</span> around the Z axis (blue arrow).
Here is an animation of the two rotations on the Bloch sphere, where the dots represent the path the qubit takes to reach its final state:</p>
<center>
    <video controls loop autoplay width="360px" height="360px">
        <source src="_static/bloch_sphere_SH.mp4" type="video/mp4">
        <source src="_static/bloch_sphere_SH.ogg" type="video/ogg">
    </video>
</center><p>The entangled state we will create between Alice and Bob is the Bell state</p>
<div class="math notranslate nohighlight">
\[\vert\beta_{00}\rangle=\frac{\vert 00\rangle+\vert 11\rangle}{\sqrt{2}}.\]</div>
<p>A quantum circuit that will prepare the three qubits in these initial states is:</p>
<a class="reference internal image-reference" href="_images/prep_circuit.png"><img alt="_images/prep_circuit.png" class="align-center" src="_images/prep_circuit.png" style="width: 300px;" /></a>
<p>The <a class="reference internal" href="api_qubits/netsquid.qubits.qubitapi.html#netsquid.qubits.qubitapi.operate" title="netsquid.qubits.qubitapi.operate"><code class="xref py py-mod docutils literal notranslate"><span class="pre">operate</span></code></a> function provided by the API is used to operate on qubits using a <em>quantum operator</em> (<a class="reference internal" href="api_qubits/netsquid.qubits.operators.html#netsquid.qubits.operators.Operator" title="netsquid.qubits.operators.Operator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Operator</span></code></a>).
Several operators are predefined in the <a class="reference internal" href="api_qubits/netsquid.qubits.operators.html#module-netsquid.qubits.operators" title="netsquid.qubits.operators"><code class="xref py py-mod docutils literal notranslate"><span class="pre">operators</span></code></a> module, including <code class="docutils literal notranslate"><span class="pre">X</span></code>, <code class="docutils literal notranslate"><span class="pre">Y</span></code>, <code class="docutils literal notranslate"><span class="pre">Z</span></code>, <code class="docutils literal notranslate"><span class="pre">I</span></code>, <code class="docutils literal notranslate"><span class="pre">H</span></code>, <code class="docutils literal notranslate"><span class="pre">S</span></code>, <code class="docutils literal notranslate"><span class="pre">T</span></code>, <code class="docutils literal notranslate"><span class="pre">CNOT</span></code> (or <code class="docutils literal notranslate"><span class="pre">CX</span></code>), <code class="docutils literal notranslate"><span class="pre">CZ</span></code> and <code class="docutils literal notranslate"><span class="pre">SWAP</span></code>.
The circuit above can be realised using operators in NetSquid as follows:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># put a1 into the chosen target state</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ns</span><span class="o">.</span><span class="n">qubits</span><span class="o">.</span><span class="n">operate</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">ns</span><span class="o">.</span><span class="n">H</span><span class="p">)</span> <span class="c1"># apply Hadamard gate to a1: |0&gt; -&gt; |+&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ns</span><span class="o">.</span><span class="n">qubits</span><span class="o">.</span><span class="n">operate</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">ns</span><span class="o">.</span><span class="n">S</span><span class="p">)</span> <span class="c1"># apply S gate to a1: |+&gt; -&gt; |0_y&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ns</span><span class="o">.</span><span class="n">qubits</span><span class="o">.</span><span class="n">reduced_dm</span><span class="p">([</span><span class="n">a1</span><span class="p">]))</span>
<span class="go">[[0.5+0.j  0. -0.5j]</span>
<span class="go"> [0. +0.5j 0.5+0.j ]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># transform a2 and b1 to the Bell state |b00&gt; = (|00&gt; + |11&gt;)/sqrt(2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ns</span><span class="o">.</span><span class="n">qubits</span><span class="o">.</span><span class="n">operate</span><span class="p">(</span><span class="n">a2</span><span class="p">,</span> <span class="n">ns</span><span class="o">.</span><span class="n">H</span><span class="p">)</span>  <span class="c1"># apply Hadamard gate to a2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ns</span><span class="o">.</span><span class="n">qubits</span><span class="o">.</span><span class="n">operate</span><span class="p">([</span><span class="n">a2</span><span class="p">,</span> <span class="n">b1</span><span class="p">],</span> <span class="n">ns</span><span class="o">.</span><span class="n">CNOT</span><span class="p">)</span>  <span class="c1"># CNOT: a2 = control, b1 = target</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ns</span><span class="o">.</span><span class="n">qubits</span><span class="o">.</span><span class="n">reduced_dm</span><span class="p">([</span><span class="n">a2</span><span class="p">,</span> <span class="n">b1</span><span class="p">]))</span>
<span class="go">[[0.5+0.j 0. +0.j 0. +0.j 0.5+0.j]</span>
<span class="go"> [0. +0.j 0. +0.j 0. +0.j 0. +0.j]</span>
<span class="go"> [0. +0.j 0. +0.j 0. +0.j 0. +0.j]</span>
<span class="go"> [0.5+0.j 0. +0.j 0. +0.j 0.5+0.j]]</span>
</pre></div>
</div>
<p>Applying operators in this way is purely an exercise in linear algebra;
it is not meant to represent the application of physical quantum gates in NetSquid.
In later sections of this tutorial we will show how quantum circuits can be represented using <em>quantum programs</em> and abstract <em>instructions</em>, and how the latter can be mapped to the physical instructions of a quantum processing device to include delay, noise etc.</p>
<p>Aside from the predefined operators, it is possible to create custom quantum operators in several ways:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Construct a new operator using existing operators:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">newOp</span> <span class="o">=</span> <span class="n">ns</span><span class="o">.</span><span class="n">CNOT</span> <span class="o">*</span> <span class="p">((</span><span class="n">ns</span><span class="o">.</span><span class="n">X</span> <span class="o">+</span> <span class="n">ns</span><span class="o">.</span><span class="n">Z</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">^</span> <span class="n">ns</span><span class="o">.</span><span class="n">I</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">newOp</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>  <span class="c1"># Note: CNOT == CX</span>
<span class="go">(CX*(((X+Z)/(1.41))^I))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Construct a new operator using a matrix:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">newOp2</span> <span class="o">=</span> <span class="n">ns</span><span class="o">.</span><span class="n">qubits</span><span class="o">.</span><span class="n">Operator</span><span class="p">(</span><span class="s2">&quot;newOp2&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="n">j</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]])</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span><span class="p">(</span><span class="n">newOp2</span><span class="o">.</span><span class="n">is_unitary</span> <span class="o">==</span> <span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span><span class="p">(</span><span class="n">newOp2</span><span class="o">.</span><span class="n">is_hermitian</span> <span class="o">==</span> <span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Construct new operators using helper functions:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">R</span> <span class="o">=</span> <span class="n">ns</span><span class="o">.</span><span class="n">create_rotation_op</span><span class="p">(</span><span class="n">angle</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="n">rotation_axis</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">R</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="go">R_x[0.79]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Construct a controlled operator:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">CR</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">ctrl</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">CR</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="go">CR_x[0.79]</span>
</pre></div>
</div>
<p>After initialising the qubits, the teleportation protocol proceeds with Alice performing a Bell state measurement on her two qubits.
She then sends the two classical bits corresponding to her measurement outcomes to Bob, who performs a possible correction.
The quantum circuit that does this is the following:</p>
<a class="reference internal image-reference" href="_images/teleportation_circuit.png"><img alt="_images/teleportation_circuit.png" class="align-center" src="_images/teleportation_circuit.png" style="width: 554px;" /></a>
<p>The <a class="reference internal" href="api_qubits/netsquid.qubits.qubitapi.html#netsquid.qubits.qubitapi.measure" title="netsquid.qubits.qubitapi.measure"><code class="xref py py-mod docutils literal notranslate"><span class="pre">measure</span></code></a> function is used to perform a projective measurement.
If no observable is specified, the measurement is made in the standard (Z observable) basis: <span class="math notranslate nohighlight">\(\{|0\rangle, |1\rangle\}\)</span>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ns</span><span class="o">.</span><span class="n">set_random_state</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>  <span class="c1"># (Ensures fixed random outcomes for our doctests)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ns</span><span class="o">.</span><span class="n">qubits</span><span class="o">.</span><span class="n">operate</span><span class="p">([</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">],</span> <span class="n">ns</span><span class="o">.</span><span class="n">CNOT</span><span class="p">)</span>  <span class="c1"># CNOT: a1 = control, a2 = target</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ns</span><span class="o">.</span><span class="n">qubits</span><span class="o">.</span><span class="n">operate</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">ns</span><span class="o">.</span><span class="n">H</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Measure a1 in the standard basis:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m1</span><span class="p">,</span> <span class="n">prob</span> <span class="o">=</span> <span class="n">ns</span><span class="o">.</span><span class="n">qubits</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="n">a1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labels_z</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;|0&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;|1&gt;&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Measured </span><span class="si">{</span><span class="n">labels_z</span><span class="p">[</span><span class="n">m1</span><span class="p">]</span><span class="si">}</span><span class="s2"> with prob </span><span class="si">{</span><span class="n">prob</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">Measured |0&gt; with prob 0.50</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Measure a2 in standard basis:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m2</span><span class="p">,</span> <span class="n">prob</span> <span class="o">=</span> <span class="n">ns</span><span class="o">.</span><span class="n">qubits</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="n">a2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Measured </span><span class="si">{</span><span class="n">labels_z</span><span class="p">[</span><span class="n">m2</span><span class="p">]</span><span class="si">}</span><span class="s2"> with prob </span><span class="si">{</span><span class="n">prob</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">Measured |1&gt; with prob 0.50</span>
</pre></div>
</div>
<p>To measure in a different basis another observable can be specified.
For example, to measure in the Hadamard (X observable) basis, <span class="math notranslate nohighlight">\(\{|+\rangle, |-\rangle\}\)</span>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q1</span><span class="p">,</span> <span class="o">=</span> <span class="n">ns</span><span class="o">.</span><span class="n">qubits</span><span class="o">.</span><span class="n">create_qubits</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m3</span><span class="p">,</span> <span class="n">prob</span> <span class="o">=</span> <span class="n">ns</span><span class="o">.</span><span class="n">qubits</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="n">q1</span><span class="p">,</span> <span class="n">observable</span><span class="o">=</span><span class="n">ns</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="n">discard</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labels_x</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;+&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Measured |</span><span class="si">{</span><span class="n">labels_x</span><span class="p">[</span><span class="n">m3</span><span class="p">]</span><span class="si">}</span><span class="s2">&gt; with prob </span><span class="si">{</span><span class="n">prob</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">Measured |-&gt; with prob 0.50</span>
</pre></div>
</div>
<p>We can for example ping-pong our qubit between two different measurement observables,
as was done in the <a class="reference external" href="quick_start.html">10 minute tutorial</a> and we will do for an upcoming example later in this tutorial:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q1</span><span class="p">,</span> <span class="o">=</span> <span class="n">ns</span><span class="o">.</span><span class="n">qubits</span><span class="o">.</span><span class="n">create_qubits</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">observable</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="p">(</span><span class="n">ns</span><span class="o">.</span><span class="n">Z</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="s2">&quot;1&quot;</span><span class="p">))</span> <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="k">else</span> <span class="p">(</span><span class="n">ns</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;+&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">))</span>
<span class="gp">... </span>    <span class="n">m</span><span class="p">,</span> <span class="n">prob</span> <span class="o">=</span> <span class="n">ns</span><span class="o">.</span><span class="n">qubits</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="n">q1</span><span class="p">,</span> <span class="n">observable</span><span class="o">=</span><span class="n">observable</span><span class="p">)</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Measured |</span><span class="si">{</span><span class="n">labels</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="si">}</span><span class="s2">&gt; with prob </span><span class="si">{</span><span class="n">prob</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">Measured |-&gt; with prob 0.50</span>
<span class="go">Measured |0&gt; with prob 0.50</span>
<span class="go">Measured |+&gt; with prob 0.50</span>
<span class="go">Measured |0&gt; with prob 0.50</span>
<span class="go">Measured |-&gt; with prob 0.50</span>
<span class="go">Measured |1&gt; with prob 0.50</span>
</pre></div>
</div>
</section>
<section id="general-measurements">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">General measurements <sup>*</sup></a><a class="headerlink" href="#general-measurements" title="Link to this heading"></a></h2>
<p>The ket vector (<a class="reference internal" href="api_qubits/netsquid.qubits.qformalism.html#id0" title="netsquid.qubits.qformalism.QFormalism.KET"><code class="xref py py-obj docutils literal notranslate"><span class="pre">KET</span></code></a>) and density matrix (<a class="reference internal" href="api_qubits/netsquid.qubits.qformalism.html#id1" title="netsquid.qubits.qformalism.QFormalism.DM"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DM</span></code></a>) formalisms also support <em>general measurements</em> (<a class="reference internal" href="api_qubits/netsquid.qubits.qubitapi.html#netsquid.qubits.qubitapi.gmeasure" title="netsquid.qubits.qubitapi.gmeasure"><code class="xref py py-func docutils literal notranslate"><span class="pre">gmeasure()</span></code></a>) on multiple qubits using a list of measurement operators.
The Bell measurement circuit from above can for example also be described as a single measurement on two qubits.
In that case the measurement operators have to be made manually.
Unlike the measure function, a general measurement will not
split the qubit from its shared quantum state.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bell_operators</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p0</span><span class="p">,</span> <span class="n">p1</span> <span class="o">=</span> <span class="n">ns</span><span class="o">.</span><span class="n">Z</span><span class="o">.</span><span class="n">projectors</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bell_operators</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ns</span><span class="o">.</span><span class="n">CNOT</span> <span class="o">*</span> <span class="p">(</span><span class="n">ns</span><span class="o">.</span><span class="n">H</span> <span class="o">^</span> <span class="n">ns</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">p0</span> <span class="o">^</span> <span class="n">p0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">ns</span><span class="o">.</span><span class="n">H</span> <span class="o">^</span> <span class="n">ns</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="o">*</span> <span class="n">ns</span><span class="o">.</span><span class="n">CNOT</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bell_operators</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ns</span><span class="o">.</span><span class="n">CNOT</span> <span class="o">*</span> <span class="p">(</span><span class="n">ns</span><span class="o">.</span><span class="n">H</span> <span class="o">^</span> <span class="n">ns</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">p0</span> <span class="o">^</span> <span class="n">p1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">ns</span><span class="o">.</span><span class="n">H</span> <span class="o">^</span> <span class="n">ns</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="o">*</span> <span class="n">ns</span><span class="o">.</span><span class="n">CNOT</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bell_operators</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ns</span><span class="o">.</span><span class="n">CNOT</span> <span class="o">*</span> <span class="p">(</span><span class="n">ns</span><span class="o">.</span><span class="n">H</span> <span class="o">^</span> <span class="n">ns</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">p1</span> <span class="o">^</span> <span class="n">p0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">ns</span><span class="o">.</span><span class="n">H</span> <span class="o">^</span> <span class="n">ns</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="o">*</span> <span class="n">ns</span><span class="o">.</span><span class="n">CNOT</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bell_operators</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ns</span><span class="o">.</span><span class="n">CNOT</span> <span class="o">*</span> <span class="p">(</span><span class="n">ns</span><span class="o">.</span><span class="n">H</span> <span class="o">^</span> <span class="n">ns</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">p1</span> <span class="o">^</span> <span class="n">p1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">ns</span><span class="o">.</span><span class="n">H</span> <span class="o">^</span> <span class="n">ns</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="o">*</span> <span class="n">ns</span><span class="o">.</span><span class="n">CNOT</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q1</span><span class="p">,</span> <span class="n">q2</span> <span class="o">=</span> <span class="n">ns</span><span class="o">.</span><span class="n">qubits</span><span class="o">.</span><span class="n">create_qubits</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ns</span><span class="o">.</span><span class="n">qubits</span><span class="o">.</span><span class="n">operate</span><span class="p">(</span><span class="n">q1</span><span class="p">,</span> <span class="n">ns</span><span class="o">.</span><span class="n">H</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">meas</span><span class="p">,</span> <span class="n">prob</span> <span class="o">=</span> <span class="n">ns</span><span class="o">.</span><span class="n">qubits</span><span class="o">.</span><span class="n">gmeasure</span><span class="p">([</span><span class="n">q1</span><span class="p">,</span> <span class="n">q2</span><span class="p">],</span> <span class="n">meas_operators</span><span class="o">=</span><span class="n">bell_operators</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labels_bell</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;|00&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;|01&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;|10&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;|11&gt;&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Measured </span><span class="si">{</span><span class="n">labels_bell</span><span class="p">[</span><span class="n">meas</span><span class="p">]</span><span class="si">}</span><span class="s2"> with prob </span><span class="si">{</span><span class="n">prob</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">Measured |10&gt; with prob 0.25</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q1</span><span class="o">.</span><span class="n">qstate</span><span class="o">.</span><span class="n">num_qubits</span><span class="p">)</span>
<span class="go">2</span>
</pre></div>
</div>
<p>Based on the measurement outcomes of Alice’s Bell state measurement, Bob may need to apply corrections to his qubit to recover the teleported quantum state of Alice.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">m2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">ns</span><span class="o">.</span><span class="n">qubits</span><span class="o">.</span><span class="n">operate</span><span class="p">(</span><span class="n">b1</span><span class="p">,</span> <span class="n">ns</span><span class="o">.</span><span class="n">X</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">m1</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">ns</span><span class="o">.</span><span class="n">qubits</span><span class="o">.</span><span class="n">operate</span><span class="p">(</span><span class="n">b1</span><span class="p">,</span> <span class="n">ns</span><span class="o">.</span><span class="n">Z</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ns</span><span class="o">.</span><span class="n">qubits</span><span class="o">.</span><span class="n">reduced_dm</span><span class="p">([</span><span class="n">b1</span><span class="p">]))</span>
<span class="go">[[0.5+0.j  0. -0.5j]</span>
<span class="go"> [0. +0.5j 0.5+0.j ]]</span>
</pre></div>
</div>
<p>We can check how close a qubit is to the desired state by checking the (squared) fidelity of the qubit.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fidelity</span> <span class="o">=</span> <span class="n">ns</span><span class="o">.</span><span class="n">qubits</span><span class="o">.</span><span class="n">fidelity</span><span class="p">(</span><span class="n">b1</span><span class="p">,</span> <span class="n">ns</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fidelity is </span><span class="si">{</span><span class="n">fidelity</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">Fidelity is 1.000</span>
</pre></div>
</div>
</section>
<section id="applying-noise">
<h2><a class="toc-backref" href="#id6" role="doc-backlink">Applying noise <sup>*</sup></a><a class="headerlink" href="#applying-noise" title="Link to this heading"></a></h2>
<p>NetSquid is built to simulate a quantum hardware as accurately as possible.
Almost all quantum hardware components are noisy and the quantum state of qubits will <a class="reference external" href="https://en.wikipedia.org/wiki/Quantum_decoherence">decohere</a> with time.</p>
<p>It might be the case that <em>b1</em> depolarized during the Bell measurement of <em>a1</em> and <em>a2</em>,
which would cause the fidelity of the teleported state to drop:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ns</span><span class="o">.</span><span class="n">qubits</span><span class="o">.</span><span class="n">delay_depolarize</span><span class="p">(</span><span class="n">b1</span><span class="p">,</span> <span class="n">depolar_rate</span><span class="o">=</span><span class="mf">1e7</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fidelity</span> <span class="o">=</span> <span class="n">ns</span><span class="o">.</span><span class="n">qubits</span><span class="o">.</span><span class="n">fidelity</span><span class="p">([</span><span class="n">b1</span><span class="p">],</span> <span class="n">reference_state</span><span class="o">=</span><span class="n">ns</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fidelity is </span><span class="si">{</span><span class="n">fidelity</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">Fidelity is 0.909</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="api_qubits/netsquid.qubits.qubitapi.html#module-netsquid.qubits.qubitapi" title="netsquid.qubits.qubitapi"><code class="xref py py-mod docutils literal notranslate"><span class="pre">qubitapi</span></code></a> module also defines some other functions to apply noise or stochastic operations on qubits.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q1</span><span class="p">,</span> <span class="n">q2</span><span class="p">,</span> <span class="n">q3</span><span class="p">,</span> <span class="n">q4</span> <span class="o">=</span> <span class="n">ns</span><span class="o">.</span><span class="n">qubits</span><span class="o">.</span><span class="n">create_qubits</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ns</span><span class="o">.</span><span class="n">qubits</span><span class="o">.</span><span class="n">stochastic_operate</span><span class="p">(</span><span class="n">q1</span><span class="p">,</span> <span class="p">[</span><span class="n">ns</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="n">ns</span><span class="o">.</span><span class="n">Y</span><span class="p">,</span> <span class="n">ns</span><span class="o">.</span><span class="n">Z</span><span class="p">],</span> <span class="n">p_weights</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ns</span><span class="o">.</span><span class="n">qubits</span><span class="o">.</span><span class="n">reduced_dm</span><span class="p">([</span><span class="n">q1</span><span class="p">]))</span>
<span class="go">[[0.25+0.j 0.  +0.j]</span>
<span class="go"> [0.  +0.j 0.75+0.j]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ns</span><span class="o">.</span><span class="n">qubits</span><span class="o">.</span><span class="n">apply_pauli_noise</span><span class="p">(</span><span class="n">q2</span><span class="p">,</span> <span class="n">p_weights</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">))</span>  <span class="c1"># (I, X, Y, Z)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ns</span><span class="o">.</span><span class="n">qubits</span><span class="o">.</span><span class="n">reduced_dm</span><span class="p">([</span><span class="n">q2</span><span class="p">]))</span>
<span class="go">[[0.5+0.j 0. +0.j]</span>
<span class="go"> [0. +0.j 0.5+0.j]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ns</span><span class="o">.</span><span class="n">qubits</span><span class="o">.</span><span class="n">depolarize</span><span class="p">(</span><span class="n">q3</span><span class="p">,</span> <span class="n">prob</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ns</span><span class="o">.</span><span class="n">qubits</span><span class="o">.</span><span class="n">reduced_dm</span><span class="p">([</span><span class="n">q3</span><span class="p">]))</span>
<span class="go">[[0.6+0.j 0. +0.j]</span>
<span class="go"> [0. +0.j 0.4+0.j]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ns</span><span class="o">.</span><span class="n">qubits</span><span class="o">.</span><span class="n">operate</span><span class="p">(</span><span class="n">q4</span><span class="p">,</span> <span class="n">ns</span><span class="o">.</span><span class="n">X</span><span class="p">)</span>  <span class="c1"># -&gt; |1&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ns</span><span class="o">.</span><span class="n">qubits</span><span class="o">.</span><span class="n">amplitude_dampen</span><span class="p">(</span><span class="n">q4</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">prob</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ns</span><span class="o">.</span><span class="n">qubits</span><span class="o">.</span><span class="n">reduced_dm</span><span class="p">([</span><span class="n">q4</span><span class="p">]))</span>
<span class="go">[[0.1+0.j 0. +0.j]</span>
<span class="go"> [0. +0.j 0.9+0.j]]</span>
</pre></div>
</div>
<section id="see-also">
<h3>See also<a class="headerlink" href="#see-also" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><a class="reference internal" href="api_qubits/netsquid.qubits.qubitapi.html#netsquid.qubits.qubitapi.dephase" title="netsquid.qubits.qubitapi.dephase"><code class="xref py py-func docutils literal notranslate"><span class="pre">dephase()</span></code></a></p></li>
<li><p><a class="reference internal" href="api_qubits/netsquid.qubits.qubitapi.html#netsquid.qubits.qubitapi.delay_depolarize" title="netsquid.qubits.qubitapi.delay_depolarize"><code class="xref py py-func docutils literal notranslate"><span class="pre">delay_depolarize()</span></code></a></p></li>
<li><p><a class="reference internal" href="api_qubits/netsquid.qubits.qubitapi.html#netsquid.qubits.qubitapi.apply_dda_noise" title="netsquid.qubits.qubitapi.apply_dda_noise"><code class="xref py py-func docutils literal notranslate"><span class="pre">apply_dda_noise()</span></code></a></p></li>
<li><p><a class="reference internal" href="api_qubits/netsquid.qubits.qubitapi.html#netsquid.qubits.qubitapi.multi_operate" title="netsquid.qubits.qubitapi.multi_operate"><code class="xref py py-func docutils literal notranslate"><span class="pre">multi_operate()</span></code></a></p></li>
<li><p><a class="reference internal" href="api_qubits/netsquid.qubits.qubitapi.html#netsquid.qubits.qubitapi.stochastic_operate" title="netsquid.qubits.qubitapi.stochastic_operate"><code class="xref py py-func docutils literal notranslate"><span class="pre">stochastic_operate()</span></code></a></p></li>
<li><p><a class="reference internal" href="api_qubits/netsquid.qubits.qformalism.html#module-netsquid.qubits.qformalism" title="netsquid.qubits.qformalism"><code class="xref py py-obj docutils literal notranslate"><span class="pre">qformalism</span></code></a></p></li>
</ul>
</section>
<section id="what-is-next">
<h3>What is next?<a class="headerlink" href="#what-is-next" title="Link to this heading"></a></h3>
<p>We have shortly touched upon the effect of time on quantum states.
Qubit operations and sending qubits or classical messages over channels take time.
In the next section we will introduce the discrete event simulator used in NetSquid to keep track of time in quantum networks.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="tutorial.intro.html" class="btn btn-neutral float-left" title="Tutorial" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="tutorial.pydynaa.html" class="btn btn-neutral float-right" title="Discrete event simulation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2017-2021, TNO and TUDelft (QuTech).</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book"> Other Versions</span>
    v: 1.1.7
    <span class="fa fa-caret-down"></span>
  </span>
  <div class="rst-other-versions">
    <dl>
      <dt>Versions</dt>
      <dd><a href="/1-1-stable/">1.1.5</a></dd>
      <dd><a href="/1-0-stable/">1.0.7</a></dd>
      <dd><a href="/0-10-stable/">0.10.4</a></dd>
      <dd><a href="/0-9-stable/">0.9.11</a></dd>
      <dd><a href="/0-8-stable/">0.8.7</a></dd>
      <dd><a href="/0-7-stable/">0.7.5</a></dd>
      <dd><a href="/0-6-stable/">0.6.4</a></dd>
      <dd><a href="/0-5-stable/">0.5.2</a></dd>
      <dd><a href="/0-4-stable/">0.4.2</a></dd>
      <dd><a href="/0-3-stable/">0.3.5</a></dd>
      <dd><a href="/latest-release/">latest release</a></dd>
      <dd><a href="/master/">master branch</a></dd>
    </dl>
  </div>
</div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 <script type="text/javascript">
    $(document).ready(function() {
        $(".highlight-default .highlight").each(function() {
            if ($(this).find(".gp").length > 0) {
             $(this).prepend("<div class='codebtn btn btn-neutral float-right'><div class='gp'>>>></div><div>");
             $(this).children("pre").contents().filter(function() {return this.nodeType === 3;}).wrap("<span></span>").end();
            }
        });
        $(".highlight-default .highlight .codebtn").click(function() {
            $(this).parent().children("pre").find(".gp").toggleClass("hidden");
            var traceback_elem = $(this).parent().children("pre").find(".gt, .go");
            traceback_elem.toggleClass("hidden");
            traceback_elem.nextUntil(".gp, .go").toggleClass("hidden");

        })
    });
</script>


</body>
</html>